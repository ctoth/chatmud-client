{"version":3,"sources":["linkembedder.js","cmoutput.js","inserts/webtts.js","inserts/mcp.js","inserts/triggers.js","inserts/programmerhelper.js","inserts/notifier.js","insertfactory.js","appendfactory.js","channelhistory.js","channelinterface.js","soundops.js","soundplayer.js","programmer.js","tts.js","interface.js","chatmud.js","tcp.js","main.js"],"names":["LinkEmbedder","constructor","re","act","text","replace","url","module","exports","require","CMOutput","domNode","instance","maxLines","linkEmbedder","add","string","tts","speak","paragraph","document","createElement","processed","HTMLEscape","innerHTML","appendChild","history","addMessage","checkScreen","addHTML","childNodes","length","WebTTS","interface","console","log","getElementById","value","MCP","key","name","toString","startsWith","slice","parsed","JSON","parse","executeMCP","command","data","authentication_key","error","output","s1","trim","indexOf","includes","s2","split","i","initMCP","connection","send","args","checkKey","info","handleChannelMessage","handleChannelSocial","handleSocial","handlePlayerConnect","handlePlayerReconnect","handlePlayerDisconnect","handlePlayerTeleportOut","handlePlayerTeleportIn","handleTell","handleEdit","handlePlay","soundPlayer","playChannel","stringify","Number","playSocial","play","args2","programmer","setObject","setEnableHelper","Triggers","executeTriggers","matched","match","ProgrammerHelper","code","receiving","enabled","setCode","open","Notifier","Notification","requestPermission","then","result","body","inserts","webtts","mcp","triggers","programmerhelper","notifier","InsertFactory","getInsert","appends","AppendFactory","getInstance","ChannelHistory","channels","Array","pChannel","message","channel","getChannelByName","Channel","push","getMessageForChannel","id","messages","unshift","ChannelInterface","currentChannel","currentMessage","nextChannel","speakImmediate","previousChannel","nextMessage","readMessage","previousMessage","sounds","findSoundsInFolder","path","directory","search","object","entry","children","findFilenames","array","returnObj","Howl","Howler","soundops","rng","Sounds","SoundPlayer","extension","file","folder","mFile","searchSounds","loadSound","sound","foundChannels","gender","socials","foundSocials","filename","Sound","basePath","src","Programmer","window","lines","currentLine","boundMethod","setTimeout","postMessage","handleMessage","bind","addEventListener","sendCode","removeEventListener","line","obj","say","TTS","speaking","speakQueue","voice","rate","stopSpeech","stop","handleQueue","shift","err","Combokeys","React","reactDom","MainUI","Interface","shortcuts","setupEvents","setupKeys","setupInterface","render","mainUI","process","platform","bindGlobal","historyInterface","setSpeechEnabled","state","Inserts","Appends","ChatMud","input","setupInserts","setupAppends","on","handleData","event","keyCode","sendInput","insertDef","insert","appendDef","append","net","EventEmitter","TCPConnection","address","port","client","Socket","connect","endsWith","emitData","arr","emit","write","game"],"mappings":"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","file":"main.map","sourcesContent":["'use strict';\n\nclass LinkEmbedder {\n\tconstructor() {\n\t\tthis.re=/(http|ftp|https):\\/\\/([\\w_-]+(?:(?:\\.[\\w_-]+)+))([\\w.,@?\\^=%:\\/~+#-]*[\\w@?\\^=%\\/~+#-])?/gi;\n\t}\n\tact(text) {\n\t\treturn text.replace(this.re, (url) => {\n/*let link=document.createElement('a');\nlink.href=url;\nlink.innerText=url;\ninstance.output.domNode.appendChild(link);*/\nreturn '<a href=\"'+url+'\">'+url+'</a>';\n\t\t});\n}\n}\n\nmodule.exports = LinkEmbedder;","'use strict';\nconst LinkEmbedder = require('./linkembedder.js');\n\nclass CMOutput {\n\tconstructor(domNode, instance) {\n\t\tthis.instance = instance;\n\t\tthis.domNode = domNode;\n\t\tthis.maxLines = 100;\n\t\tthis.linkEmbedder = new LinkEmbedder();\n\t}\n\n\tadd(string) {\n\t\tif (string != '') {\n\t\t\tthis.instance.tts.speak(string);\n\t\t\tconst paragraph = document.createElement('p');\n\t\t\t/*\t\t\tConst text = document.createTextNode(string);\n\t\t\tparagraph.appendChild(text); */\n\t\t\tlet processed = this.HTMLEscape(string);\n\t\t\tprocessed = this.linkEmbedder.act(processed);\n\t\t\tparagraph.innerHTML = processed;\n\t\t\tthis.domNode.appendChild(paragraph);\n\t\t\tthis.instance.history.addMessage('MudOutput', string);\n\t\t}\n\n\t\tthis.checkScreen();\n\t}\n\n\tHTMLEscape(string) {\n\t\t    return string.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;');\n\t}\n\n\taddHTML(string) {\n\n\t}\n\n\tcheckScreen() {\n\t\tif (this.domNode.childNodes.length > this.maxLines) {\n\t\t\t// This.domNode.removeChild(this.domNode.firstChild);\n\t\t}\n\t}\n}\n\nmodule.exports = CMOutput;\n","'use strict';\n\nclass WebTTS {\n\tconstructor() {\n\t\tthis.interface = null;\n\t}\n\n\tact(string, instance) {\n\t\tthis.instance = instance;\n\t\tconsole.log(document.getElementById('speechToggle').value);\n\t\tthis.instance.tts.speak(string);\n\t\treturn string;\n\t}\n}\n\nmodule.exports = WebTTS;\n","'use strict';\nclass MCP {\n\tconstructor() {\n\t\tthis.instance = null;\n\t\tthis.key = 0;\n\t\tthis.name = 0;\n\t}\n\n\tact(string, instance) {\n\t\tstring = string.toString();\n\t\tif (!string.startsWith('#$#')) {\n\t\t\treturn string;\n\t\t}\n\n\t\tthis.instance = instance;\n\t\tif (string.startsWith(\"#$#json\")) {\n\t\t\ttry {\n\t\t\t\tstring = string.slice(8, string.length);\n\t\t\t\tlet parsed = JSON.parse(string);\n\t\t\t\tthis.executeMCP(parsed.command, parsed.data, parsed.authentication_key);\n\t\t\t} catch (error) {\n\t\t\t\tthis.instance.output.add(\"Error parsing MCP: \" + string);\n\t\t\t}\n\t\t\t\n\t\t} else {\n\t\t\t\t\tthis.parse(string);\n\t\t}\n\t\t\n\n\t\treturn '';\n\t}\n\n\tparse(string) {\n\t\tconsole.log('Parsing ' + string);\n\t\tlet s1 = string.slice(3, string.length);\n\t\ts1 = s1.trim();\n\t\tlet command = s1.slice(0, s1.indexOf(' '));\n\n\t\tcommand = command.trim();\n\t\tconsole.log('Command: ' + command);\n\t\ts1 = s1.slice(command.length, s1.length);\n\t\tlet key = null;\n\t\tif (s1.includes('-|-')) {\n\t\t\tkey = s1.slice(s1.indexOf('-|-') + 4, s1.length);\n\t\t\tkey = key.trim();\n\t\t\ts1 = s1.slice(0, s1.indexOf('-|-'));\n\t\t}\n\n\t\tconst s2 = s1.split('|');\n\t\tfor (let i = 0; i < s2.length; i++) {\n\t\t\ts2[i] = s2[i].trim();\n\t\t}\n\n\t\tif (command == 'mcp') {\n\t\t\tthis.initMCP();\n\t\t}\n\n\t\tthis.executeMCP(command, s2, key);\n\t}\n\n\tinitMCP() {\n\t\tthis.instance.connection.send('#$#register_client Chatmud Official Client (Alpha)');\n\t\tthis.instance.connection.send('#$#client_supports authkeys');\n\tthis.instance.connection.send('#$#client_supports json');\n\t}\n\n\texecuteMCP(command, args, key) {\n\t\tif (key) {\n\t\t\tthis.checkKey(key);\n\t\t}\n\n\t\tswitch (command) {\n\t\t\tcase 'authentication_key':\n\t\t\t\tthis.key = args[0];\n\t\t\t\tthis.instance.info.key = args[0];\n\t\t\t\tbreak;\n\t\t\tcase 'my_name':\n\t\t\t\tthis.name = args[0];\n\t\t\t\tthis.instance.info.name = args[0];\n\t\t\t\tbreak;\n\t\t\tcase 'channel_message':\n\t\t\tthis.handleChannelMessage(args);\n\t\t\t\tbreak;\n\t\t\tcase 'channel_social':\n\t\t\tthis.handleChannelSocial(args);\n\t\t\t\tbreak;\n\t\t\tcase 'social':\n\t\t\tthis.handleSocial(args);\n\t\t\t\tbreak;\n\n\t\t\tcase 'watched_player_connect':\n\t\t\tthis.handlePlayerConnect(args);\n\t\t\t\tbreak;\n\t\t\tcase 'watched_player_reconnect':\n\t\t\tthis.handlePlayerReconnect(args);\n\t\t\t\tbreak;\n\t\t\tcase 'watched_player_disconnect':\n\t\t\tthis.handlePlayerDisconnect(args);\n\t\t\t\tbreak;\n\t\t\tcase 'teleport_out':\n\t\t\tthis.handlePlayerTeleportOut(args);\n\t\t\t\tbreak;\n\t\t\tcase 'teleport_in':\n\t\t\tthis.handlePlayerTeleportIn(args);\n\t\t\t\tbreak;\n\t\t\tcase 'tell_message':\n\t\t\tthis.handleTell(args);\n\t\t\t\tbreak;\n\t\t\tcase 'edit':\n\t\t\tthis.handleEdit(args);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\tthis.handlePlay(command, args);\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\thandleChannelMessage(args) {\n\t\tthis.instance.history.addMessage(args[0], args[2] + args[3]);\n\t\tthis.instance.output.add(args[2] + ' ' + args[3]);\n\t\tthis.instance.soundPlayer.playChannel(args[0]);\n\t}\n\n\thandleChannelSocial(args) {\n\t\tconsole.log(JSON.stringify(args));\n\t\tthis.instance.history.addMessage(args[0], args[0] + Number(': ') + args[3]);\n\t\tthis.instance.output.add(args[0] + ': ' + args[3]);\n\t\tthis.instance.soundPlayer.playSocial(args[2], args[5]);\n\t\tthis.instance.soundPlayer.playChannel(args[0]);\n\t}\n\n\thandleSocial(args) {\n\t\tthis.instance.soundPlayer.playSocial(args[0], args[2]);\n\t}\n\n\thandlePlay(command, args) {\n\t\tthis.instance.soundPlayer.play(args[0], command);\n\t}\n\n\thandlePlayerConnect(args) {\n\t\tthis.instance.soundPlayer.play('enter');\n\t\tthis.instance.output.add(args[0] + ' connected');\n\t}\n\n\thandlePlayerReconnect(args) {\n\t\tthis.instance.soundPlayer.play('reconnect');\n\t\tthis.instance.output.add(args[0] + ' reconnected');\n\t}\n\n\thandlePlayerDisconnect(args) {\n\t\tthis.instance.soundPlayer.play('leave');\n\t\tthis.instance.output.add(args[0] + ' disconnected');\n\t}\n\n\thandlePlayerTeleportOut(args) {\n\t\tthis.instance.soundPlayer.play('teleport%20out', 'misc');\n\t}\n\n\thandlePlayerTeleportIn(args) {\n\t\tthis.instance.soundPlayer.play('teleport%20in', 'misc');\n\t}\n\n\thandleTell(args) {\n\t\tconsole.log('Parsed tell: ' + args);\n\t\tthis.instance.soundPlayer.play('tell');\n\t\tthis.instance.output.add(args[0] + ' ' + args[1] + ' ' + args[2]);\n\t}\n\n\thandleEdit(args) {\n\t\tconst args2 = args[0].split(' ');\n\t\t// Console.log(\"Split args: \" + JSON.stringify(args2));\n\t\t// let verb = args2[1].split(\":\")[1];\n\t\t// let object = args2[4].split(\":\")[0];\n\t\tthis.instance.programmer.setObject(args2[args2.length - 1]);\n\t\tthis.instance.programmer.setEnableHelper(true);\n\t}\n\n\tcheckKey(key) {\n\t\tconsole.log('Checking ' + key + ' agains ' + this.key);\n\t\tif (key != this.key) {\n\t\t\tthis.instance.soundPlayer.play('spoofer', 'misc');\n\t\t\tthis.instance.output.add('Spoof attempt!');\n\t\t}\n\t}\n}\n\nmodule.exports = MCP;\n","'use strict';\n\nclass Triggers {\n\tconstructor() {\n\t\tthis.instance = null;\n\t}\n\n\tact(string, instance) {\n\t\tthis.instance = instance;\n\t\tthis.executeTriggers(string);\n\t\treturn string;\n\t}\n\n\texecuteTriggers(string) {\n\t\tlet matched = string.match('^Turning (off|on) channel ([a-zA-Z0-9]*)?\\.');\n\t\tif (matched) {\n\t\t\tthis.instance.soundPlayer.play(matched[1]);\n\t\t}\n\n\t\tmatched = string.match('^I don\\'t understand that\\.$');\n\t\tif (matched) {\n\t\t\tthis.instance.soundPlayer.play('huh', 'misc');\n\t\t}\n\n\t\tmatched = string.match('^(\\>\\> Command Aborted \\<\\<|Invalid selection.)$');\n\t\tif (matched) {\n\t\t\tthis.instance.soundPlayer.play('cancel');\n\t\t}\n\n\t\tmatched = string.match('(\\\\[(Type a line of input or `@abort\\' to abort the command|Type lines of input; use `\\\\.\\' to end or `@abort\\' to abort the command)\\\\.\\\\]|\\\\[Enter `yes\\' or `no\\'\\\\])');\n\t\tif (matched) {\n\t\t\tthis.instance.soundPlayer.play('prompt');\n\t\t}\n\n\t\tmatched = string.match('You click your heels three times.');\n\t\tif (matched) {\n\t\t\tthis.instance.soundPlayer.play('home', 'misc');\n\t\t}\n\n\t\tmatched = string.match('[Connections] A new high player count has been reached! * players are connected.');\n\t\tif (matched) {\n\t\t\tthis.instance.soundPlayer.play('high%connections', 'misc');\n\t\t}\n\n\t\tmatched = string.match('[Creation] * has just connected for the first time! Please make them feel welcome.');\n\t\tif (matched) {\n\t\t\tthis.instance.soundPlayer.play('creation');\n\t\t}\n\n\t\tmatched = string.match('(.*) says,(.*)');\n\t\tif (matched) {\n\t\t\tthis.instance.soundPlayer.play('say');\n\t\t}\n\n\t\tmatched = string.match('^You say,*?');\n\t\tif (matched) {\n\t\t\tthis.instance.soundPlayer.play('say');\n\t\t}\n\t}\n}\n\nmodule.exports = Triggers;\n","class ProgrammerHelper {\n\tconstructor() {\n\t\tthis.code = '';\n\t\tthis.receiving = false;\n\t\tthis.instance = null;\n\t}\n\n\tact(string, instance) {\n\t\tif (instance.programmer.enabled == true) {\n\t\t\tif (this.receiving == false) {\n\t\t\t\tthis.receiving = true;\n\t\t\t\tthis.code = '';\n\t\t\t}\n\n\t\t\tthis.instance = instance;\n\t\t\t\t\tconsole.log('Checking: ' + string);\n\t\t\t\t\tif (string == '.') {\n\t\t\tthis.instance.programmer.setCode(this.code);\n\t\t\tthis.instance.programmer.open();\n\t\t\tthis.instance.programmer.setEnableHelper(false);\n\t\t\tthis.receiving = false;\n\t\t\t\t\t}\n\t\t\t\t\tthis.code += string + '\\n';\n\t\t\t\t\treturn '';\n\t\t}\n\t\treturn string;\n\t}\n}\n\nmodule.exports = ProgrammerHelper;\n","'use strict';\n\nclass Notifier {\n\tconstructor() {\n\t\tthis.instance = null;\n\t\tNotification.requestPermission().then(result => console.log('Notification result: ' + result));\n\t}\n\n\tact(string, instance) {\n\t\tstring = string.toString();\n\t\tthis.instance = instance;\n\t\tif (this.instance.info.name != '') {\n\t\t\tif (string.includes(this.instance.info.name)) {\n\t\t\t\tconsole.log('Sending notification');\n\t\t\t\tnew Notification('ChatMud', {\n\t\t\t\t\tbody: 'You\\'ve been mentioned! ' + string});\n\t\t\t}\n\t\t}\n\t\treturn string;\n\t}\n}\n\nmodule.exports = Notifier;\n","'use strict';\n\n\nconst inserts={\n\twebtts: require('./inserts/webtts'),\n\tmcp: require('./inserts/mcp'),\n\ttriggers: require('./inserts/triggers'),\n\tprogrammerhelper: require('./inserts/programmerhelper'),\n\tnotifier: require('./inserts/notifier'),\n}\n\nclass InsertFactory {\n\tstatic getInsert(name) {\n\t\treturn inserts[name];\n\t}\n}\n\nmodule.exports = InsertFactory;\n","'use strict';\nconst appends = {\n};\nclass AppendFactory {\n\tstatic getInstance(instance) {\n\t\treturn appends[instance];\n\t}\n}\n\nmodule.exports = AppendFactory;\n","'use strict';\nclass ChannelHistory {\n\tconstructor() {\n\t\tthis.channels = new Array();\n\t}\n\n\taddMessage(pChannel, message) {\n\t\tconsole.log('Adding to ' + pChannel + ', ' + message);\n\t\tlet channel = this.getChannelByName(pChannel);\n\t\tif (channel == -1) {\n\t\t\tchannel = new Channel(pChannel);\n\t\t\tthis.channels.push(channel);\n\t\t\tconsole.log('Created new channel');\n\t\t}\n\t\tchannel.addMessage(message);\n\t}\n\n\tgetChannelByName(name) {\n\t\tconsole.log('Getting channel by name ' + name);\n\t\tfor (const channel of this.channels) {\n\t\t\tif (channel.name == name) {\n\t\t\t\treturn channel;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t}\n\n\tgetMessageForChannel(name, id) {\n\t\tconsole.log('Getting message ' + id + ' for channel ' + name);\n\t\tconst channel = this.getChannelByName(name);\n\t\treturn channel.messages[id];\n\t}\n}\n\nclass Channel {\n\tconstructor(name) {\n\t\tthis.name = name;\n\t\tthis.messages = new Array();\n\t}\n\n\taddMessage(message) {\n\t\tconsole.log('In-channel message add: ' + message);\n\t\tthis.messages.unshift(message);\n\t}\n}\n\nmodule.exports = ChannelHistory;\n","'use strict';\nconst ChannelHistory = require('./channelhistory');\n\nclass ChannelInterface {\n\tconstructor(history, instance) {\n\t\tthis.instance = instance;\n\t\tthis.currentChannel = 0;\n\t\tthis.currentMessage = 0;\n\t\tthis.history = history;\n\t}\n\n\tnextChannel() {\n\t\tconsole.log('Next channel');\n\t\tif (this.currentChannel < this.history.channels.length - 1) {\n\t\t\tthis.currentChannel++;\n\t\t} else {\n\t\t\tthis.currentChannel = this.history.channels.length - 1;\n\t\t}\n\n\t\tthis.instance.tts.speakImmediate(this.history.channels[this.currentChannel].name);\n\t}\n\n\tpreviousChannel() {\n\t\tconsole.log('Previous channel');\n\t\tif (this.currentChannel > 0) {\n\t\t\tthis.currentChannel--;\n\t\t} else {\n\t\t\tthis.currentChannel = 0;\n\t\t}\n\n\t\t\t\tthis.instance.tts.speakImmediate(this.history.channels[this.currentChannel].name);\n\t}\n\n\tnextMessage() {\n\t\tconsole.log('Next message');\n\t\tif (this.currentMessage > 0) {\n\t\t\tthis.currentMessage--;\n\t\t} else {\n\t\t\tthis.currentMessage = 0;\n\t\t}\n\n\t\tthis.readMessage(this.currentMessage);\n\t}\n\n\tpreviousMessage() {\n\t\tconsole.log('Previous message');\n\t\tif (this.currentMessage < this.history.channels[this.currentChannel].messages.length - 1) {\n\t\t\tthis.currentMessage++;\n\t\t} else {\n\t\t\tthis.currentMessage = this.history.channels[this.currentChannel].messages.length - 1;\n\t\t}\n\n\t\tthis.readMessage(this.currentMessage);\n\t}\n\n\treadMessage(id) {\n\t\tconsole.log('Reading ' + this.history.channels[this.currentChannel].messages[id]);\n\t\tthis.instance.tts.speakImmediate(this.history.channels[this.currentChannel].messages[id]);\n\t}\n}\n\nmodule.exports = ChannelInterface;\n","const sounds = require('./sounds');\n\nfunction findSoundsInFolder(path) {\n\tconst split = path.split('/');\n\tlet directory = sounds;\n\tfor (const string of split) {\n\t\tdirectory = search(string, directory);\n\t}\n\treturn directory;\n}\n\nfunction search(string, object) {\n\tfor (const entry of object) {\n\t\tif (entry.name == string) {\n\t\t\treturn entry.children;\n\t\t}\n\t}\n}\n\nfunction findFilenames(string, array) {\n\tconst returnObj = [];\n\tfor (const entry of array) {\n\t\tif (entry.name.includes(string)) {\nreturnObj.push(entry.name);\n\t\t}\n\t}\n\treturn returnObj;\n}\n\nmodule.exports.findSoundsInFolder = findSoundsInFolder;\nmodule.exports.findFilenames = findFilenames;\n","const {Howl, Howler} = require('howler');\nconst soundops = require('./soundops');\nconst rng = require('random-int');\nconst Sounds = require('./sounds');\n\nclass SoundPlayer {\n\tconstructor() {\n\t\tthis.sounds = new Array();\n\t\tthis.extension = '.ogg';\n\t}\n\n\tplay(file, folder = '') {\n\t\tlet mFile = this.searchSounds(file, folder);\n\t\tif (mFile == -1) {\n\t\t\tmFile = this.loadSound(file, folder);\n\t\t}\n\t\tmFile.sound.play();\n\t}\n\n\tplayChannel(name) {\n\t\tconst channels = soundops.findSoundsInFolder('channels');\n\t\tconst foundChannels = soundops.findFilenames(name, channels);\n\t\tname = (foundChannels.length == 0 ? 'global' : name);\n\t\tthis.play(name, 'channels');\n\t}\n\n\tplaySocial(name, gender) {\n\t\tconst socials = soundops.findSoundsInFolder('socials');\n\t\tlet foundSocials = soundops.findFilenames(name + ' ' + gender, socials);\n\t\tif (foundSocials.length == 0) {\n\t\t\tfoundSocials = soundops.findFilenames(name, socials);\n\t\t}\n\t\tlet filename = null;\n\t\tif (foundSocials.length > 0) {\n\t\t\tfilename = foundSocials[rng(0, foundSocials.length - 1)].toString();\n\t\t\tfilename = filename.slice(0, filename.length - 4);\n\t\t}\n\n\t\tif (!filename) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.play(filename, 'socials');\n\t}\n\n\tsearchSounds(file, folder) {\n\t\tfor (const sound of this.sounds) {\n\t\t\tif (sound.file == file && sound.folder == folder) {\n\t\t\t\treturn sound;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t}\n\n\tloadSound(file, folder) {\n\t\tconst sound = new Sound(folder, file);\n\t\tthis.sounds.push(sound);\n\t\treturn sound;\n\t}\n}\n\nclass Sound {\n\tconstructor(folder, file) {\n\t\tthis.basePath = './sounds/';\n\t\tthis.file = file;\n\t\tthis.folder = folder;\n\t\tthis.extension = '.ogg';\n\t\tthis.path = this.basePath + this.folder + '/' + this.file + this.extension;\n\n\t\tconsole.log('Loading ' + this.path);\n\t\tthis.sound = new Howl({src: this.path});\n\t}\n}\n\nmodule.exports = SoundPlayer;\n","'use strict';\n\nclass Programmer {\n\tconstructor(instance) {\n\t\tthis.instance = instance;\n\t\tthis.code = '';\n\t\tthis.object = '';\n\t\tthis.enabled = false;\n\t\tthis.window = null;\n\t\tthis.lines = new Array();\n\t\tthis.currentLine = 0;\n\t\tthis.boundMethod = null;\n\t}\n\n\tsetEnableHelper(value) {\n\t\tthis.enabled = value;\n\t}\n\n\tsetCode(code) {\n\t\tthis.code = code;\n\t\tconsole.log('Code: ' + this.code);\n\t}\n\n\topen() {\n\t\tthis.window = window.open('./editor.html');\n\t\tsetTimeout(() => {\n\t\t\tthis.window.postMessage(this.code);\n\t\t}, 1000);\n\t\tthis.boundMethod = this.handleMessage.bind(this);\n\t\twindow.addEventListener('message', this.boundMethod);\n\t}\n\n\thandleMessage(data) {\n\t\tconst code = data.data;\n\t\t\t\t\tthis.sendCode(code);\n\t\t\t\t\twindow.removeEventListener('message', this.boundMethod);\n\t}\n\n\tsendCode(data) {\n\t\tconst lines = data.split('\\n');\n\t\tthis.lines = lines;\n\t\tthis.instance.connection.send('@program ' + this.object);\n\t\tfor (const line of lines) {\n\t\t\t\tthis.instance.connection.send(line);\n\t\t}\n\t\t\tthis.instance.connection.send('.');\n\t\t\tthis.code = '';\n\t\t\tthis.enabled = false;\n\t}\n\n\tsetObject(obj) {\n\t\tconsole.log('Object set to ' + this.object);\n\t\tthis.object = obj;\n\t}\n}\n\nmodule.exports = Programmer;\n","const say = require('say');\n\nclass TTS {\n\tconstructor() {\n\t\tthis.enabled = true;\n\t\tthis.speaking = false;\n\t\tthis.speakQueue = new Array();\n\t\tthis.voice = 'alex';\n\t\tthis.rate = 3.0;\n\t}\n\n\tstopSpeech() {\n\t\tif (this.speaking == true) {\n\t\t\tthis.speaking = false;\n\t\t\tthis.speakQueue = [];\n\t\t\tsay.stop();\n\t\t}\n\t}\n\n\tspeakImmediate(string) {\n\t\tif (this.speaking == true) {\n\t\t\tthis.stopSpeech();\n\t\t}\n\t\t\t\t\tthis.speak(string);\n\t}\n\n\tspeak(string) {\n\t\tif (!this.enabled) {\n\t\t\treturn;\n\t\t}\n\t\tstring = string.replace('[', ' ');\n\t\tstring = string.replace(']', ' ');\n\tconsole.log('saying ' + string);\n\tthis.speakQueue.push(string);\n\tif (this.speaking == false) {\n\tthis.handleQueue();\n\tthis.speaking = true;\n\t}\n\t}\n\n\thandleQueue() {\n\t\tif (this.speakQueue.length > 0) {\n\t\t\tconst string = this.speakQueue.shift();\n\t\t\tsay.speak(string, this.voice, this.rate, err => this.handleQueue());\n\t\t} else {\n\t\t\tthis.speaking = false;\n\t\t}\n\t}\n}\n\nmodule.exports = TTS;\n","'use strict';\nconst Combokeys = require('combokeys');\nconst React = require(\"react\");\nconst reactDom = require(\"react-dom\");\nconst MainUI = require(\"ui/main\");\n\nclass Interface {\n\tconstructor(instance) {\n\t\tthis.instance = instance;\n\t\tthis.shortcuts = new Combokeys(window);\n\t\trequire('combokeys/plugins/global-bind')(this.shortcuts);\n\t\tthis.setupEvents();\n\t\tthis.setupKeys();\n\t\tthis.setupInterface();\n\t}\n\n\tsetupInterface() {\n\t\treactDom.render(mainUI, document.getElementById(\"app\"));\n\t}\n\t\n\tsetupKeys() {\n\t\tif (process.platform === 'win32') {\n\t\t\tthis.shortcuts.bindGlobal('alt+left', () => this.instance.historyInterface.previousChannel());\n\t\t\tthis.shortcuts.bindGlobal('alt+right', () => this.instance.historyInterface.nextChannel());\n\t\t\tthis.shortcuts.bindGlobal('alt+up', () => this.instance.historyInterface.previousMessage());\n\t\t\tthis.shortcuts.bindGlobal('alt+down', () => this.instance.historyInterface.nextMessage());\n\t\t} else {\n\t\t\tthis.shortcuts.bindGlobal('alt+meta+left', () => this.instance.historyInterface.previousChannel());\n\t\t\tthis.shortcuts.bindGlobal('alt+meta+right', () => this.instance.historyInterface.nextChannel());\n\t\t\tthis.shortcuts.bindGlobal('alt+meta+up', () => this.instance.historyInterface.previousMessage());\n\t\t\tthis.shortcuts.bindGlobal('alt+meta+down', () => this.instance.historyInterface.nextMessage());\n\t\t}\n\t\t\t\tthis.shortcuts.bindGlobal('ctrl', () => this.instance.tts.stopSpeech());\n\t\t\t\tthis.shortcuts.bindGlobal('f12', () => this.setSpeechEnabled(!this.instance.tts.enabled));\n\t}\n\n\tsetupEvents() {\n\n\t}\n\n\tsetSpeechEnabled(state) {\n\t\tthis.instance.tts.enabled = state;\n\t\tthis.instance.output.add('Speech ' + (state ? 'enabled' : 'disabled'));\n\t}\n}\n\nmodule.exports = Interface;\n","'use strict';\nconst CMOutput = require('./cmoutput');\nconst Inserts = require('./inserts.json');\nconst InsertFactory = require('./insertfactory');\nconst Appends = require('./appends.json');\nconst AppendFactory = require('./appendfactory');\nconst ChannelHistory = require('./channelhistory');\nconst ChannelInterface = require('./channelinterface');\nconst SoundPlayer = require('./soundplayer');\nconst Programmer = require('./programmer');\nconst TTS = require('./tts');\nconst Interface = require('./interface');\n\nclass ChatMud {\n\tconstructor(connection) {\n\t\tconsole.log('Constructing handler');\n\t\tthis.input = document.getElementById('cm-input');\n\t\tthis.output = new CMOutput(document.getElementById('cm-output'), this);\n\t\tthis.connection = connection;\n\t\tthis.inserts = new Array();\n\t\tthis.appends = new Array();\n\t\tthis.history = new ChannelHistory();\n\t\tthis.historyInterface = new ChannelInterface(this.history, this);\n\t\tthis.soundPlayer = new SoundPlayer();\n\t\tthis.tts = new TTS();\n\t\tthis.interface = new Interface(this);\n\t\tthis.programmer = new Programmer(this);\n\t\tthis.info = {\n\t\t\tname: '',\n\t\t\tkey: ''\n\t\t};\n\n\t\tthis.setupEvents();\n\t\tthis.setupInserts();\n\t\tthis.setupAppends();\n\t}\n\n\tsetupEvents() {\n\t\tconsole.log('Setting events');\n\t\tthis.connection.on('data', data => this.handleData(data));\n\t\tthis.input.addEventListener('keyup', event => {\n\t\t\tif (event.keyCode == 13) {\n\t\t\t\tthis.tts.stopSpeech();\n\t\t\t\tthis.sendInput();\n\t\t\t}\n\t\t});\n\t}\n\n\tsetupInserts() {\n\t\tfor (const insertDef of Inserts) {\n\t\t\tconst insert = InsertFactory.getInsert(insertDef);\n\t\t\tconst instance = new insert();\n\t\t\tthis.inserts.push(instance);\n\t\t}\n\t}\n\n\tsetupAppends() {\n\t\tfor (const appendDef of Appends) {\n\t\t\tconst append = AppendFactory.getInstance(appendDef);\n\t\t\tconst instance = new append();\n\t\t\tthis.appends.push(instance);\n\t\t}\n\t}\n\n\thandleData(data) {\n\t\t\tconsole.log('Received data: ' + data);\n\t\t\tfor (const insert of this.inserts) {\n\t\t\t\tdata = insert.act(data, this);\n\t\t\t}\n\n\t\t\tthis.output.add(data);\n\n\t\t\tfor (const append of this.appends) {\n\t\t\t\tconsole.log('Appending');\n\t\t\t\tappend.act(data, this);\n\t\t\t}\n\t}\n\n\tsendInput() {\n\t\tconsole.log('Handle enter key');\n\n\t\tconst string = this.input.value;\n\t\tif (string == 'my_name') {\n\t\t\tthis.output.add('Your name is set to ' + this.info.name);\n\t\t}\n\n\t\tthis.connection.send(string);\n\t\tthis.input.value = '';\n\t}\n}\n\nmodule.exports = ChatMud;\n","'use strict';\nconst net = require('net');\nconst EventEmitter = require('eventemitter3');\n\nclass TCPConnection extends EventEmitter {\n\tconstructor(address = 'chatmud.com', port = 3000) {\n\t\tconsole.log('Connecting to ' + address + ' on port ' + port);\n\t\tsuper();\n\t\tthis.address = address;\n\t\tthis.port = port;\n\t\tthis.client = new net.Socket();\n\t\tthis.connection = this.client.connect(this.port, this.address, () => this.setupEvents());\n\t\tthis.data = null;\n\t}\n\n\tsetupEvents() {\n\t\tconsole.log('Setting up tcp events');\n\t\tthis.client.on('data', data => this.handleData(data));\n\t}\n\n\thandleData(data) {\n\t\tconsole.log('TCP stream: ' + data);\n\n\t\tconst string = data.toString();\n\t\tthis.data += string;\n\t\tif (this.data.endsWith('\\n')) {\n\t\t\tthis.emitData(this.data);\n\t\t\tthis.data = '';\n\t\t}\n\t}\n\n\temitData(data) {\n\t\tconst arr = data.split('\\r\\n');\n\t\tfor (const i of arr) {\n\t\tthis.emit('data', i);\n\t\t}\n\t}\n\n\tsend(string) {\n\t\tconsole.log('Sending ' + string);\n\t\tthis.client.write(string + '\\n');\n\t}\n}\n\nmodule.exports = TCPConnection;\n","'use strict';\nconst ChatMud = require('./chatmud.js');\nconst TCPConnection = require('./tcp.js');\nconst SoundPlayer = require('./soundplayer');\n\n// AddEventListener(\"DOMContentLoaded\", () => {\n\tconsole.log('Starting connection...');\nconst connection = new TCPConnection();\nconsole.log('Creating handler...');\nconst game = new ChatMud(connection);\n// });\n"]}